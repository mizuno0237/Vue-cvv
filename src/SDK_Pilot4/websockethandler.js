/* MIT License:
*
* Copyright (c) 2010-2012, Joe Walnes
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
* THE SOFTWARE.
*/
/**
* This behaves like a WebSocket in every way, except if it fails to connect,
* or it gets disconnected, it will repeatedly poll until it succesfully connects
* again.
*
* It is API compatible, so when you have:
*   ws = new WebSocket('ws://....');
* you can replace with:
*   ws = new ReconnectingWebSocket('ws://....');
*
* The event stream will typically look like:
*  onconnecting
*  onopen
*  onmessage
*  onmessage
*  onclose // lost connection
*  onconnecting
*  onopen  // sometime later...
*  onmessage
*  onmessage
*  etc... 
*
* It is API compatible with the standard WebSocket API.
*
* Latest version: https://github.com/joewalnes/reconnecting-websocket/
* - Joe Walnes
*/
/**
* 
* @param {type} url
* @param {type} protocols
* @param {type} viewerObject
* @returns {ReconnectingWebSocket}
*/
var _$_ede9=["debug","reconnectInterval","timeoutInterval","forcedClose","url","protocols","readyState","CONNECTING","URL","binaryType","viewerObj","resHandler","maxRetryCount","getRPQueryString","?","Primary url.....","logDebug","onopen","reconnect ws binaryType::"," readyState: ","arraybuffer","sendFirstMessage","onclose","getSessionStatus","SESSION_RECONNECTING","RP_SESSION_STATE","Primary connection is closed....","CLOSED","notifyPrimaryConnectionState","onconnecting","onconnecting.readyState: ","isKVMAppliance","getLoginInfo","getLoginStatus","PRIMARY_SOCKET_EXCEPTION","setSessionException","ReconnectingWebSocket onconnecting.report error and do not retry","ReconnectingWebSocket onconnecting.report error","onmessage","getResponseHandler","data","handleResponse","onerror","self.readyState..","debugAll","ReconnectingWebSocket","attempt-connect","connection-timeout","close","PrimarySocket onOpen.....","OPEN","ReconnectingWebSocket::onClose......."," self.readyState::"," forcedClose::"," Reason::","code","Certificate verification may failed.","ReconnectingWebSocket connect again....","onerror.......","Exception on primary connection...","toString","SecurityError","Websocket SecurityError Close connection.","exception at connect","getState","sendData","send","Failed to send data. Primary Web socket is closed","INVALID_STATE_ERR WS(1): Pausing to reconnect websocket","closeConnection","Primary WebSocket connection is closed","terminate","Primary WebSocket connection is terminated...","refresh","wss://","ws://","/","",":","lws-dvc-protocol","videoResHandler","Secondary url.....","video web socket opened  binaryType::","WSS_DATA_MODE","WSS_BINARY_DATA_MODE","Secondary connection is closed....","notifySecondaryConnectionState","SECONDARY_SOCKET_EXCEPTION","AvctVideoWebSocket onconnecting.report error and do not retry","AvctVideoWebSocket onconnecting.report error","getVideoResponseHandler","protocol. "," webSocketTimeout","isPrimaryConnectionClosed","AvctVideoWebSocket - Primary connection is not yet reconnected. Wait for it....","AvctVideoWebSocket","AvctVideoWebSocket::onClose.......","connect AvctVideoWebSocket again...","Exception on secondary connection...","INVALID_STATE_ERR  WS(2): Pausing to reconnect websocket","Secondary WebSocket connection is terminated..."];function ReconnectingWebSocket(_0x24CEF,_0x24CA7,_0x24CFB,_0x24CD7){_0x24CA7= _0x24CA7|| [];this[_$_ede9[0]]= false;this[_$_ede9[1]]= (_0x24CD7* 1000);this[_$_ede9[2]]= (_0x24CD7* 1000);this[_$_ede9[3]]= false;var _0x24CCB=this;var _0x24D07;var _0x24CE3=false;var _0x24CB3=0;this[_$_ede9[4]]= _0x24CEF;this[_$_ede9[5]]= _0x24CA7;this[_$_ede9[6]]= WebSocket[_$_ede9[7]];this[_$_ede9[8]]= _0x24CEF;this[_$_ede9[9]]= null;this[_$_ede9[10]]= _0x24CFB;this[_$_ede9[11]]= null;this[_$_ede9[12]]= 0;if(this[_$_ede9[10]]!== null){var _0x24CBF=this[_$_ede9[10]][_$_ede9[13]]();if(_0x24CBF!== null){_0x24CEF+= _$_ede9[14]+ _0x24CBF};Logger[_$_ede9[16]](_$_ede9[15]+ _0x24CEF)}else {return null};this[_$_ede9[17]]= function(_0x24C9B){_0x24CB3= 0;Logger[_$_ede9[16]](_$_ede9[18]+ _0x24D07[_$_ede9[9]]+ _$_ede9[19]+ _0x24D07[_$_ede9[6]]);_0x24D07[_$_ede9[9]]= _$_ede9[20];if(_0x24CCB[_$_ede9[10]]!== null){_0x24CCB[_$_ede9[10]][_$_ede9[21]]()}};this[_$_ede9[22]]= function(_0x24C9B){if(_0x24CCB[_$_ede9[3]]=== false){if(_0x24CCB[_$_ede9[10]]!== null&& _0x24CCB[_$_ede9[10]][_$_ede9[23]]()!== RPViewer[_$_ede9[25]][_$_ede9[24]]){Logger[_$_ede9[16]](_$_ede9[26]);_0x24CCB[_$_ede9[10]][_$_ede9[28]](WebSocket[_$_ede9[27]])}}else {if(_0x24CCB[_$_ede9[10]]!== null){_0x24CCB[_$_ede9[10]][_$_ede9[28]](WebSocket[_$_ede9[27]])}}};this[_$_ede9[29]]= function(_0x24C9B){if(_0x24D07!== null){Logger[_$_ede9[16]](_$_ede9[30]+ _0x24D07[_$_ede9[6]])}else {if(_0x24CCB[_$_ede9[10]]!== null){if(_0x24CCB[_$_ede9[10]][_$_ede9[31]]()&& _0x24CCB[_$_ede9[10]][_$_ede9[32]]()&& _0x24CB3=== 0&& (_0x24CCB[_$_ede9[10]][_$_ede9[32]]()[_$_ede9[33]]()=== 8|| _0x24CCB[_$_ede9[10]][_$_ede9[32]]()[_$_ede9[33]]()=== 4)){_0x24CB3++}else {_0x24CCB[_$_ede9[10]][_$_ede9[35]](APCPPacket[_$_ede9[34]]);if(_0x24CCB[_$_ede9[10]][_$_ede9[23]]()!== RPViewer[_$_ede9[25]][_$_ede9[24]]){_0x24CCB[_$_ede9[3]]= true;Logger[_$_ede9[16]](_$_ede9[36])}else {Logger[_$_ede9[16]](_$_ede9[37])}}}}};this[_$_ede9[38]]= function(_0x24C9B){if(_0x24CCB[_$_ede9[10]]!== null&& _0x24CCB[_$_ede9[11]]=== null){_0x24CCB[_$_ede9[11]]= _0x24CCB[_$_ede9[10]][_$_ede9[39]]()};if(_0x24CCB[_$_ede9[11]]!== null){_0x24CCB[_$_ede9[11]][_$_ede9[41]](_0x24C9B[_$_ede9[40]])}};this[_$_ede9[42]]= function(_0x24C9B){};function _0x24C9B(_0x24CBF){try{_0x24D07=  new WebSocket(_0x24CEF,_0x24CA7);Logger[_$_ede9[16]](_$_ede9[43]+ _0x24D07[_$_ede9[6]]);_0x24CCB[_$_ede9[29]]();if(_0x24CCB[_$_ede9[0]]|| ReconnectingWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[45],_$_ede9[46],_0x24CEF)};var _0x24CD7=null;if(_0x24CCB[_$_ede9[10]]!== null&& _0x24CCB[_$_ede9[10]][_$_ede9[23]]()=== RPViewer[_$_ede9[25]][_$_ede9[24]]){var _0x24CB3=_0x24D07;_0x24CD7= setTimeout(function(){if(_0x24CCB[_$_ede9[0]]|| ReconnectingWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[45],_$_ede9[47],_0x24CEF)};_0x24CE3= true;_0x24CB3[_$_ede9[48]]();_0x24CE3= false},_0x24CCB[_$_ede9[2]])};_0x24D07[_$_ede9[17]]= function(_0x24C9B){Logger[_$_ede9[16]](_$_ede9[49]);if(_0x24CD7!== null){clearTimeout(_0x24CD7)};if(_0x24CCB[_$_ede9[0]]|| ReconnectingWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[45],_$_ede9[17],_0x24CEF)};_0x24CCB[_$_ede9[6]]= WebSocket[_$_ede9[50]];_0x24CBF= false;_0x24CCB[_$_ede9[17]](_0x24C9B)};_0x24D07[_$_ede9[22]]= function(_0x24CA7){Logger[_$_ede9[16]](_$_ede9[51]+ _$_ede9[52]+ _0x24CCB[_$_ede9[6]]+ _$_ede9[53]+ _0x24CCB[_$_ede9[3]]+ _$_ede9[54]+ _0x24CA7[_$_ede9[55]]);if(_0x24CA7[_$_ede9[55]]=== 1015){Logger[_$_ede9[16]](_$_ede9[56]);_0x24CCB[_$_ede9[3]]= true;_0x24CCB[_$_ede9[10]][_$_ede9[35]](APCPPacket[_$_ede9[34]])};_0x24D07= null;if(_0x24CCB[_$_ede9[3]]){_0x24CCB[_$_ede9[6]]= WebSocket[_$_ede9[27]];_0x24CCB[_$_ede9[22]](_0x24CA7)}else {_0x24CCB[_$_ede9[6]]= WebSocket[_$_ede9[7]];_0x24CCB[_$_ede9[29]]();if(!_0x24CBF&&  !_0x24CE3){if(_0x24CCB[_$_ede9[0]]|| ReconnectingWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[45],_$_ede9[22],_0x24CEF)};_0x24CCB[_$_ede9[22]](_0x24CA7)};setTimeout(function(){if(_0x24CCB[_$_ede9[3]]=== false){Logger[_$_ede9[16]](_$_ede9[57]);_0x24C9B(true)}},_0x24CCB[_$_ede9[1]])}};_0x24D07[_$_ede9[38]]= function(_0x24C9B){if(_0x24CCB[_$_ede9[0]]|| ReconnectingWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[45],_$_ede9[38],_0x24CEF,_0x24C9B[_$_ede9[40]])};_0x24CCB[_$_ede9[38]](_0x24C9B)};_0x24D07[_$_ede9[42]]= function(_0x24C9B){Logger[_$_ede9[16]](_$_ede9[58]+ _0x24C9B[_$_ede9[55]]);if(_0x24CCB[_$_ede9[0]]|| ReconnectingWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[45],_$_ede9[42],_0x24CEF,_0x24C9B)};_0x24CCB[_$_ede9[42]](_0x24C9B)}}catch(e){Logger[_$_ede9[16]](_$_ede9[59]+ e[_$_ede9[60]]());if(e[_$_ede9[60]]()=== _$_ede9[61]){Logger[_$_ede9[16]](_$_ede9[62]);_0x24CCB[_$_ede9[3]]= true;_0x24CCB[_$_ede9[10]][_$_ede9[35]](null)}}}try{_0x24C9B(_0x24CEF)}catch(e){Logger[_$_ede9[16]](_$_ede9[63]+ e);_0x24CCB[_$_ede9[10]][_$_ede9[35]](null)};this[_$_ede9[64]]= function(){return _0x24CCB[_$_ede9[6]]};this[_$_ede9[65]]= function(_0x24C9B){if(_0x24D07){if(_0x24CCB[_$_ede9[0]]|| ReconnectingWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[45],_$_ede9[66],_0x24CEF,_0x24C9B)};if(_0x24CCB[_$_ede9[6]]=== WebSocket[_$_ede9[50]]){return _0x24D07[_$_ede9[66]](_0x24C9B)}else {Logger[_$_ede9[16]](_$_ede9[67])}}else {throw _$_ede9[68]}};this[_$_ede9[69]]= function(){_0x24CCB[_$_ede9[3]]= true;if(_0x24D07){_0x24D07[_$_ede9[48]]();Logger[_$_ede9[16]](_$_ede9[70])}};this[_$_ede9[71]]= function(){if(_0x24D07){_0x24D07[_$_ede9[48]]();Logger[_$_ede9[16]](_$_ede9[72])}};this[_$_ede9[73]]= function(){if(_0x24D07){_0x24D07[_$_ede9[48]]()}}}ReconnectingWebSocket[_$_ede9[44]]= false;function AvctVideoWebSocket(_0x24CB3,_0x24CCB,_0x24CBF,_0x24D2B,_0x24C9B,_0x24D07){var _0x24D1F;if(_0x24C9B){_0x24D1F= _$_ede9[74]}else {_0x24D1F= _$_ede9[75]};this[_$_ede9[10]]= _0x24D2B;var _0x24CFB=_0x24CBF?_0x24CBF+ _$_ede9[76]:_$_ede9[77];_0x24D1F= _0x24D1F+ _0x24CB3+ _$_ede9[78]+ _0x24CCB+ _$_ede9[76]+ _0x24CFB;if(this[_$_ede9[10]]!== null){var _0x24CE3=this[_$_ede9[10]][_$_ede9[13]]();if(_0x24CE3!== null){_0x24D1F+= _$_ede9[14]+ _0x24CE3}}else {return null};protocols= _$_ede9[79];this[_$_ede9[0]]= false;this[_$_ede9[1]]= (_0x24D07* 1000);this[_$_ede9[2]]= (_0x24D07* 1000);var _0x24CEF=this;var _0x24D37;this[_$_ede9[3]]= false;var _0x24D13=false;var _0x24CD7=0;this[_$_ede9[4]]= _0x24D1F;this[_$_ede9[5]]= protocols;this[_$_ede9[6]]= WebSocket[_$_ede9[7]];this[_$_ede9[8]]= _0x24D1F;this[_$_ede9[9]]= null;this[_$_ede9[80]]= null;Logger[_$_ede9[16]](_$_ede9[81]+ _0x24D1F);this[_$_ede9[17]]= function(_0x24C9B){_0x24CD7= 0;Logger[_$_ede9[16]](_$_ede9[82]+ _0x24D37[_$_ede9[9]]);ResponseHandler[_$_ede9[83]]= AVSPPacket[_$_ede9[84]];_0x24D37[_$_ede9[9]]= _$_ede9[20]};this[_$_ede9[22]]= function(_0x24C9B){if(_0x24CEF[_$_ede9[3]]=== false){if(_0x24CEF[_$_ede9[10]]!== null&& _0x24CEF[_$_ede9[10]][_$_ede9[23]]()!== RPViewer[_$_ede9[25]][_$_ede9[24]]){Logger[_$_ede9[16]](_$_ede9[85]);_0x24CEF[_$_ede9[10]][_$_ede9[86]](WebSocket[_$_ede9[27]])}}else {if(_0x24CEF[_$_ede9[10]]!== null){_0x24CEF[_$_ede9[10]][_$_ede9[86]](WebSocket[_$_ede9[27]])}}};this[_$_ede9[29]]= function(_0x24C9B){if(_0x24D37!== null){Logger[_$_ede9[16]](_$_ede9[30]+ _0x24D37[_$_ede9[6]])}else {_0x24CEF[_$_ede9[10]][_$_ede9[35]](APCPPacket[_$_ede9[87]]);if(_0x24CEF[_$_ede9[10]][_$_ede9[23]]()!== RPViewer[_$_ede9[25]][_$_ede9[24]]){Logger[_$_ede9[16]](_$_ede9[88]);_0x24CEF[_$_ede9[3]]= true}else {Logger[_$_ede9[16]](_$_ede9[89])}}};this[_$_ede9[38]]= function(_0x24C9B){if(_0x24CEF[_$_ede9[10]]!== null&& _0x24CEF[_$_ede9[80]]=== null){_0x24CEF[_$_ede9[80]]= _0x24CEF[_$_ede9[10]][_$_ede9[90]]()};if(_0x24CEF[_$_ede9[80]]!== null){_0x24CEF[_$_ede9[80]][_$_ede9[41]](_0x24C9B[_$_ede9[40]])}};this[_$_ede9[42]]= function(_0x24C9B){};function _0x24CA7(_0x24CB3){Logger[_$_ede9[16]](_$_ede9[91]+ protocols+ _$_ede9[92]+ _0x24CEF[_$_ede9[2]]);try{if(_0x24CEF[_$_ede9[3]]=== false&& _0x24CEF[_$_ede9[10]][_$_ede9[93]]()){Logger[_$_ede9[16]](_$_ede9[94]);setTimeout(function(){_0x24CA7(true)},_0x24CEF[_$_ede9[1]]);return};_0x24D37=  new WebSocket(_0x24D1F,protocols);_0x24CEF[_$_ede9[29]]();if(_0x24CEF[_$_ede9[0]]|| AvctVideoWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[95],_$_ede9[46],_0x24D1F)};var _0x24CBF=null;if(_0x24CEF[_$_ede9[10]]!== null&& _0x24CEF[_$_ede9[10]][_$_ede9[23]]()=== RPViewer[_$_ede9[25]][_$_ede9[24]]){var _0x24C9B=_0x24D37;_0x24CBF= setTimeout(function(){if(_0x24CEF[_$_ede9[0]]|| AvctVideoWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[95],_$_ede9[47],_0x24D1F)};_0x24D13= true;_0x24C9B[_$_ede9[48]]();_0x24D13= false},_0x24CEF[_$_ede9[2]])};_0x24D37[_$_ede9[17]]= function(_0x24C9B){if(_0x24CBF!== null){clearTimeout(_0x24CBF)};if(_0x24CEF[_$_ede9[0]]|| AvctVideoWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[95],_$_ede9[17],_0x24D1F)};_0x24CEF[_$_ede9[6]]= WebSocket[_$_ede9[50]];_0x24CB3= false;_0x24CEF[_$_ede9[17]](_0x24C9B)};_0x24D37[_$_ede9[22]]= function(_0x24C9B){Logger[_$_ede9[16]](_$_ede9[96]+ _$_ede9[52]+ _0x24CEF[_$_ede9[6]]+ _$_ede9[53]+ _0x24CEF[_$_ede9[3]]+ _$_ede9[54]+ _0x24C9B[_$_ede9[55]]);if(_0x24C9B[_$_ede9[55]]=== 1015){Logger[_$_ede9[16]](_$_ede9[56]);_0x24CEF[_$_ede9[3]]= true;_0x24CEF[_$_ede9[10]][_$_ede9[35]](APCPPacket[_$_ede9[87]])};_0x24D37= null;if(_0x24CEF[_$_ede9[3]]){_0x24CEF[_$_ede9[6]]= WebSocket[_$_ede9[27]];_0x24CEF[_$_ede9[22]](_0x24C9B)}else {_0x24CEF[_$_ede9[6]]= WebSocket[_$_ede9[7]];_0x24CEF[_$_ede9[29]]();if(!_0x24CB3&&  !_0x24D13){if(_0x24CEF[_$_ede9[0]]|| AvctVideoWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[95],_$_ede9[22],_0x24D1F)};_0x24CEF[_$_ede9[22]](_0x24C9B)};if(_0x24CEF[_$_ede9[3]]=== false){setTimeout(function(){Logger[_$_ede9[16]](_$_ede9[97]);_0x24CA7(true)},_0x24CEF[_$_ede9[1]])}}};_0x24D37[_$_ede9[38]]= function(_0x24C9B){if(_0x24CEF[_$_ede9[0]]|| AvctVideoWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[95],_$_ede9[38],_0x24D1F,_0x24C9B[_$_ede9[40]])};_0x24CEF[_$_ede9[38]](_0x24C9B)};_0x24D37[_$_ede9[42]]= function(_0x24C9B){if(_0x24CEF[_$_ede9[0]]|| AvctVideoWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[95],_$_ede9[42],_0x24D1F,_0x24C9B)};_0x24CEF[_$_ede9[42]](_0x24C9B)}}catch(e){Logger[_$_ede9[16]](_$_ede9[98]+ e)}}try{_0x24CA7(_0x24D1F)}catch(e){Logger[_$_ede9[16]](_$_ede9[63]+ e);_0x24CEF[_$_ede9[10]][_$_ede9[35]](null)};this[_$_ede9[65]]= function(_0x24C9B){if(_0x24D37){if(_0x24CEF[_$_ede9[0]]|| ReconnectingWebSocket[_$_ede9[44]]){Logger[_$_ede9[16]](_$_ede9[95],_$_ede9[66],_0x24D1F,_0x24C9B)};return _0x24D37[_$_ede9[66]](_0x24C9B)}else {throw _$_ede9[99]}};this[_$_ede9[64]]= function(){return _0x24CEF[_$_ede9[6]]};this[_$_ede9[69]]= function(){_0x24CEF[_$_ede9[3]]= true;if(_0x24D37){_0x24D37[_$_ede9[48]]()}};this[_$_ede9[71]]= function(){if(_0x24D37){_0x24D37[_$_ede9[48]]();Logger[_$_ede9[16]](_$_ede9[100])}};this[_$_ede9[73]]= function(){if(_0x24D37){_0x24D37[_$_ede9[48]]()}}}AvctVideoWebSocket[_$_ede9[44]]= false